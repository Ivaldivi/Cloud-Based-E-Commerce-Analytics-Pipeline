<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Diagram</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // Simple icon components (replacing Lucide)
        const Icon = ({ children, className = "", size = 24 }) => (
          <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            {children}
          </svg>
        );

        const Clock = ({ className, size }) => (
          <Icon className={className} size={size}>
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </Icon>
        );

        const Layers = ({ className, size }) => (
          <Icon className={className} size={size}>
            <polygon points="12 2 2 7 12 12 22 7 12 2"/>
            <polyline points="2 17 12 22 22 17"/>
            <polyline points="2 12 12 17 22 12"/>
          </Icon>
        );

        const HardDrive = ({ className, size }) => (
          <Icon className={className} size={size}>
            <line x1="22" y1="12" x2="2" y2="12"/>
            <path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/>
            <line x1="6" y1="16" x2="6.01" y2="16"/>
            <line x1="10" y1="16" x2="10.01" y2="16"/>
          </Icon>
        );

        const GitBranch = ({ className, size }) => (
          <Icon className={className} size={size}>
            <line x1="6" y1="3" x2="6" y2="15"/>
            <circle cx="18" cy="6" r="3"/>
            <circle cx="6" cy="18" r="3"/>
            <path d="M18 9a9 9 0 0 1-9 9"/>
          </Icon>
        );

        const Database = ({ className, size }) => (
          <Icon className={className} size={size}>
            <ellipse cx="12" cy="5" rx="9" ry="3"/>
            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
          </Icon>
        );

        const Search = ({ className, size }) => (
          <Icon className={className} size={size}>
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </Icon>
        );

        const Table = ({ className, size }) => (
          <Icon className={className} size={size}>
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <line x1="3" y1="9" x2="21" y2="9"/>
            <line x1="3" y1="15" x2="21" y2="15"/>
            <line x1="9" y1="3" x2="9" y2="21"/>
          </Icon>
        );

        const FileJson = ({ className, size }) => (
          <Icon className={className} size={size}>
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="10" y1="12" x2="10" y2="18"/>
            <line x1="14" y1="12" x2="14" y2="18"/>
          </Icon>
        );

        const ArchitectureDiagram = () => {
          return (
            <div className="w-full min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8">
              <div className="max-w-6xl mx-auto">
                <h1 className="text-3xl font-bold text-center mb-2 text-slate-800">
                  E-Commerce Event Analytics Pipeline
                </h1>
                <p className="text-center text-slate-600 mb-8">Production-Grade Incremental ETL Architecture</p>
                
                <div className="relative">
                  {/* Data Generation Layer */}
                  <div className="mb-8">
                    <div className="flex items-center gap-2 mb-4">
                      <Clock className="text-blue-600" size={24} />
                      <h2 className="text-xl font-semibold text-slate-700">Data Generation</h2>
                    </div>
                    
                    <div className="flex items-center gap-4">
                      {/* EventBridge */}
                      <div className="bg-orange-50 border-2 border-orange-300 rounded-lg p-4 shadow-md w-48">
                        <Clock className="text-orange-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">EventBridge</h3>
                        <p className="text-sm text-slate-600">Triggers every 5 min</p>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Lambda */}
                      <div className="bg-orange-50 border-2 border-orange-300 rounded-lg p-4 shadow-md w-56">
                        <Layers className="text-orange-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Lambda Function</h3>
                        <p className="text-sm text-slate-600">Generates 500K-750K events</p>
                        <p className="text-xs text-slate-500 mt-1">JSON Lines + gzip</p>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Source Bucket */}
                      <div className="bg-green-50 border-2 border-green-400 rounded-lg p-4 shadow-md w-64">
                        <HardDrive className="text-green-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Source S3 Bucket</h3>
                        <p className="text-sm text-slate-600">Raw Events (Bronze)</p>
                        <p className="text-xs text-slate-500 mt-1 font-mono break-all">events/year=/month=/day=/hour=/minute=</p>
                        <p className="text-xs text-orange-600 mt-1">*.jsonl.gz files</p>
                      </div>
                    </div>
                  </div>

                  {/* ETL Processing Layer */}
                  <div className="mb-8 mt-12">
                    <div className="flex items-center gap-2 mb-4">
                      <GitBranch className="text-purple-600" size={24} />
                      <h2 className="text-xl font-semibold text-slate-700">ETL Processing (Hourly)</h2>
                    </div>

                    <div className="flex items-center gap-4">
                      {/* Glue Job Trigger */}
                      <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4 shadow-md w-48">
                        <Clock className="text-purple-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Glue Trigger</h3>
                        <p className="text-sm text-slate-600">Scheduled: Every hour</p>
                        <p className="text-xs text-slate-500 mt-1">cron(0 * * * ? *)</p>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Glue Job */}
                      <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4 shadow-md w-64">
                        <Database className="text-purple-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Glue ETL Job</h3>
                        <p className="text-sm text-slate-600">Apache Spark</p>
                        <ul className="text-xs text-slate-500 mt-2 space-y-1">
                          <li>âœ“ Job Bookmarks (incremental)</li>
                          <li>âœ“ Parse timestamps</li>
                          <li>âœ“ Add partition columns</li>
                          <li>âœ“ Convert to Parquet</li>
                        </ul>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Analytics Bucket */}
                      <div className="bg-blue-50 border-2 border-blue-400 rounded-lg p-4 shadow-md w-64">
                        <HardDrive className="text-blue-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Analytics S3 Bucket</h3>
                        <p className="text-sm text-slate-600">Transformed Data (Gold)</p>
                        <p className="text-xs text-slate-500 mt-1 font-mono break-all">analytics/year=/month=/day=/hour=</p>
                        <p className="text-xs text-blue-600 mt-1">*.parquet files</p>
                      </div>
                    </div>
                  </div>

                  {/* Cataloging Layer */}
                  <div className="mb-8 mt-12">
                    <div className="flex items-center gap-2 mb-4">
                      <Table className="text-indigo-600" size={24} />
                      <h2 className="text-xl font-semibold text-slate-700">Data Cataloging</h2>
                    </div>

                    <div className="flex items-center gap-4">
                      {/* Crawler Trigger */}
                      <div className="bg-indigo-50 border-2 border-indigo-300 rounded-lg p-4 shadow-md w-48">
                        <GitBranch className="text-indigo-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Crawler Trigger</h3>
                        <p className="text-sm text-slate-600">Conditional</p>
                        <p className="text-xs text-slate-500 mt-1">On Job SUCCESS</p>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Glue Crawler */}
                      <div className="bg-indigo-50 border-2 border-indigo-300 rounded-lg p-4 shadow-md w-64">
                        <Search className="text-indigo-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Glue Crawler</h3>
                        <p className="text-sm text-slate-600">Schema Discovery</p>
                        <ul className="text-xs text-slate-500 mt-2 space-y-1">
                          <li>âœ“ Scans Parquet files</li>
                          <li>âœ“ Infers schema</li>
                          <li>âœ“ Discovers partitions</li>
                          <li>âœ“ Updates catalog</li>
                        </ul>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Glue Database */}
                      <div className="bg-indigo-50 border-2 border-indigo-300 rounded-lg p-4 shadow-md w-64">
                        <Database className="text-indigo-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Glue Data Catalog</h3>
                        <p className="text-sm text-slate-600">Metadata Repository</p>
                        <p className="text-xs text-slate-500 mt-2">Table: capstone_analytics</p>
                        <p className="text-xs text-slate-500">Database: studentid-analytics-db</p>
                      </div>
                    </div>
                  </div>

                  {/* Query Layer */}
                  <div className="mt-12">
                    <div className="flex items-center gap-2 mb-4">
                      <Search className="text-teal-600" size={24} />
                      <h2 className="text-xl font-semibold text-slate-700">Analytics & Querying</h2>
                    </div>

                    <div className="flex items-center gap-4">
                      {/* Athena */}
                      <div className="bg-teal-50 border-2 border-teal-400 rounded-lg p-4 shadow-md w-72 mx-auto">
                        <Search className="text-teal-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Amazon Athena</h3>
                        <p className="text-sm text-slate-600">Serverless SQL Queries</p>
                        <ul className="text-xs text-slate-500 mt-2 space-y-1">
                          <li>âœ“ Conversion funnel analysis</li>
                          <li>âœ“ Hourly revenue metrics</li>
                          <li>âœ“ Top products by views</li>
                          <li>âœ“ Category performance</li>
                          <li>âœ“ User activity analysis</li>
                        </ul>
                      </div>

                      {/* Arrow */}
                      <div className="flex-1 flex items-center">
                        <div className="h-0.5 bg-slate-400 flex-1"></div>
                        <div className="w-0 h-0 border-t-8 border-b-8 border-l-8 border-transparent border-l-slate-400"></div>
                      </div>

                      {/* Results Bucket */}
                      <div className="bg-teal-50 border-2 border-teal-400 rounded-lg p-4 shadow-md w-56">
                        <FileJson className="text-teal-600 mb-2" size={32} />
                        <h3 className="font-bold text-slate-800">Query Results</h3>
                        <p className="text-sm text-slate-600">S3 Output Location</p>
                        <p className="text-xs text-slate-500 mt-1 font-mono">athena-results/</p>
                      </div>
                    </div>
                  </div>

                  {/* Key Features Box */}
                  <div className="mt-12 bg-amber-50 border-2 border-amber-300 rounded-lg p-6 shadow-lg">
                    <h3 className="font-bold text-slate-800 text-lg mb-3">ðŸŽ¯ Key Pipeline Features</h3>
                    <div className="grid grid-cols-3 gap-4 text-sm">
                      <div>
                        <p className="font-semibold text-slate-700">Incremental Processing</p>
                        <p className="text-xs text-slate-600">Glue Job Bookmarks track processed files</p>
                      </div>
                      <div>
                        <p className="font-semibold text-slate-700">Optimized Storage</p>
                        <p className="text-xs text-slate-600">Parquet columnar format with partitioning</p>
                      </div>
                      <div>
                        <p className="font-semibold text-slate-700">Automated Orchestration</p>
                        <p className="text-xs text-slate-600">Conditional triggers ensure data freshness</p>
                      </div>
                    </div>
                  </div>

                  {/* Data Flow Stats */}
                  <div className="mt-6 bg-slate-100 border border-slate-300 rounded-lg p-4">
                    <h3 className="font-semibold text-slate-700 mb-2">Pipeline Metrics</h3>
                    <div className="grid grid-cols-4 gap-4 text-center text-sm">
                      <div>
                        <p className="text-2xl font-bold text-blue-600">500K-750K</p>
                        <p className="text-xs text-slate-600">Events per file</p>
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-purple-600">5 min</p>
                        <p className="text-xs text-slate-600">Data generation frequency</p>
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-indigo-600">1 hour</p>
                        <p className="text-xs text-slate-600">ETL processing cycle</p>
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-teal-600">4 levels</p>
                        <p className="text-xs text-slate-600">Partition depth (yr/mo/day/hr)</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ArchitectureDiagram />);
    </script>
</body>
</html>